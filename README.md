# Hear - Horror Call App

疑似的な着信を鳴らし、電話にでるとホラー演出になるPWAアプリです。肝試しや文化祭のお化け屋敷などの場面で客を怖がらせるツールとして使用できます。

## 機能

### 基本機能
- **PWA対応**: オフライン動作とアプリライクな体験
- **P2P通信**: デバイス間でリアルタイム通信
- **2デバイス構成**: 受信デバイスと操作デバイスの分離
- **バックグラウンド動作**: Service Workerによる背景動作

### 受信デバイス（①）の機能
- リアルな着信画面の表示（赤い画面、文字化けした発信者名）
- 着信音とバイブレーション
- 電話応答後の30秒間ホラー音声再生
- ノイズと人の声が混じった不気味な音響効果

### 操作デバイス（②）の機能
- **架電する（演出）**: デフォルトのホラー演出を実行
- **架電する（本物）**: 実際の通話（ボイスチェンジ付き）
- **着信音を変更**: 複数の着信音パターン
- **バイブレーションを変更**: 振動パターンの変更
- **架電者の名前を設定**: カスタム発信者名

### 追加機能
- **デバッグコンソール**: タイトルを5回タップで表示
- **音声エフェクト**: ピッチ変更、ディストーション、リバーブ
- **自動更新**: 常に最新版を使用

## セットアップ

### 1. ファイルの準備
```
Hear/
├── index.html      # メインHTML
├── app.js          # アプリケーションロジック
├── manifest.json   # PWA設定
├── sw.js           # Service Worker
├── create_icons.html # アイコン生成ツール
└── README.md       # このファイル
```

### 2. アイコンの作成
1. `create_icons.html` をブラウザで開く
2. 「Download 192px Icon」と「Download 512px Icon」をクリック
3. ダウンロードしたファイルを `icon-192.png`, `icon-512.png` として保存

### 3. Webサーバーの起動
HTTPSが必要です（マイクとP2P通信のため）:

```bash
# Python 3を使用する場合
python -m http.server 8000

# Node.jsのhttp-serverを使用する場合
npx http-server -p 8000 -S
```

### 4. GitHub Pagesでのデプロイ
1. GitHubリポジトリを作成
2. ファイルをアップロード
3. Settings > Pages > Source を "Deploy from a branch" に設定
4. Branch を "main" に設定

## 使用方法

### 初期設定
1. 2台のデバイスでアプリにアクセス
2. タイトル画面で「Hear」をタップ
3. 各デバイスで役割を選択:
   - **受信デバイス**: ターゲット（怖がらせたい人）が持つ
   - **操作デバイス**: 操作者が持つ

### 接続手順
1. 両デバイスでピアIDが自動生成される
2. 操作デバイスで受信デバイスのピアIDを入力
3. 「接続開始」をタップ
4. 接続完了後、それぞれの画面に移行

### 操作方法
#### 操作デバイス側
- **架電する（演出）**: 標準のホラー演出を実行
- **架電する（本物）**: ボイスチェンジ付きの実際の通話
- **設定変更**: 着信音、バイブレーション、発信者名をカスタマイズ

#### 受信デバイス側
- 着信が来るまで待機
- 着信時は電話アイコンをタップして応答
- ×ボタンで着信拒否

### デバッグ機能
- タイトル画面で「Hear」を5回タップするとコンソールが表示
- コンソールでJavaScriptコマンドを実行可能
- 接続状況やエラーの確認が可能

## 技術仕様

### 使用技術
- **HTML5/CSS3/JavaScript**: フロントエンド
- **Service Worker**: PWA機能とキャッシュ管理
- **PeerJS**: P2P通信ライブラリ
- **Web Audio API**: 音声処理とエフェクト
- **Navigator API**: マイクアクセスとバイブレーション

### 対応ブラウザ
- Chrome/Edge 80+
- Firefox 72+
- Safari 13.1+
- モバイルブラウザ対応

### 必要な権限
- **マイクアクセス**: 本物通話機能用
- **通知**: バックグラウンド動作用
- **バイブレーション**: 着信演出用

## トラブルシューティング

### 接続できない場合
1. 両デバイスがHTTPS環境にあることを確認
2. ピアIDが正しく入力されているか確認
3. ネットワーク環境（ファイアウォール）を確認
4. ブラウザのコンソールでエラーを確認

### 音声が出ない場合
1. デバイスの音量設定を確認
2. ブラウザの音声設定を確認
3. マイクの権限が許可されているか確認

### PWAがインストールできない場合
1. HTTPSでアクセスしているか確認
2. manifest.jsonが正しく読み込まれているか確認
3. アイコンファイルが存在するか確認

## 注意事項

### 安全な使用のために
- 相手の同意を得てから使用してください
- 心臓の弱い方や妊娠中の方への使用は避けてください
- 大音量での使用は聴覚に悪影響を与える可能性があります
- 公共の場での使用は周囲に配慮してください

### プライバシー
- P2P通信により、音声データは直接デバイス間でやり取りされます
- サーバーには通信データは保存されません
- マイクアクセスは本物通話機能でのみ使用されます

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 開発者向け情報

### カスタマイズ
- `app.js`の`createHorrorAudio()`でホラー音声をカスタマイズ可能
- CSSでUIデザインの変更が可能
- 新しい音響エフェクトを`setupVoiceChanger()`に追加可能

### デバッグ
- ブラウザのDevToolsでリアルタイムデバッグ
- コンソール機能で動作状況の確認
- Service Workerのログでキャッシュ状況を確認

---

**Hear v1.0.0** - Horror Call PWA Application